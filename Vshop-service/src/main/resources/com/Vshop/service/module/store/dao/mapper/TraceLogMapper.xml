<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.Vshop.service.module.store.dao.mapper.TracelogMapper">
    <resultMap id="BaseResultMap" type="com.Vshop.core.entity.base.TraceLog">
        <result column="strace_id" property="straceId" jdbcType="INTEGER" />
        <result column="strace_storeid" property="straceStoreid" jdbcType="INTEGER" />
        <result column="strace_storename" property="straceStorename" jdbcType="VARCHAR" />
        <result column="strace_storelogo" property="straceStorelogo" jdbcType="VARCHAR" />
        <result column="strace_title" property="straceTitle" jdbcType="VARCHAR" />
        <result column="strace_content" property="straceContent" jdbcType="VARCHAR" />
        <result column="strace_time" property="straceTime" jdbcType="VARCHAR" />
        <result column="strace_cool" property="straceCool" jdbcType="INTEGER" />
        <result column="strace_spread" property="straceSpread" jdbcType="INTEGER" />
        <result column="strace_comment" property="straceComment" jdbcType="INTEGER" />
        <result column="strace_type" property="straceType" jdbcType="INTEGER" />
        <result column="strace_goodsdata" property="straceGoodsdata" jdbcType="VARCHAR" />
        <result column="strace_state" property="straceState" jdbcType="INTEGER" />
        <result column="is_del" property="isDel" jdbcType="TINYINT" />
        <result column="created_time" property="createdTime" jdbcType="BIGINT" />
        <result column="updated_time" property="updatedTime" jdbcType="BIGINT" />
    </resultMap>

    <sql id="Base_Column_List">
        strace_id, strace_storeid, strace_storename, strace_storelogo,strace_title,strace_content,strace_time,
        strace_cool,strace_spread,strace_comment,strace_type,strace_goodsdata,strace_state,is_del,created_time,updated_time
    </sql>

	<sql id="whereStatement">
		<where>
			1 = 1
			and a.is_del = 0
			<if test="condition.straceStorename != null">
	          	and a.strace_storename like CONCAT('%',#{condition.straceStorename, jdbcType=VARCHAR},'%') 
	        </if>
	        <if test="condition.straceContent != null">
	          	and a.strace_content like CONCAT('%',#{condition.straceContent, jdbcType=VARCHAR},'%') 
	        </if>
	        <if test="condition.straceType != null">
	          	and a.strace_type = #{condition.straceType, jdbcType=INTEGER}  
	        </if>
	        <if test="condition.starttime != null">
				and created_time &gt;= #{condition.starttime}   
			</if>
			<if test="condition.endtime != null">
				and created_time &lt;= #{condition.endtime} 
			</if>
	        
		</where>
	</sql>
	
	<!--  分页查询count -->
    <select id="countTraceLog" resultType="int" parameterType="com.Vshop.service.utils.page.Pager">
        select count(1) from  shop_store_sns_tracelog a 
        <include refid="whereStatement" />
    </select>
	
	<!--  分页查询List -->
    <select id="queryTraceLogList" resultMap="BaseResultMap" parameterType="com.Vshop.service.utils.page.Pager">
        select <include refid="Base_Column_List" /> from shop_store_sns_tracelog a
      	<include refid="whereStatement" /> and strace_id >= (select strace_id from shop_store_sns_tracelog order by strace_id limit #{start}, 1) limit #{pageSize}
    </select>
    
    <!--  根据ID删除数据 -->
    <update id="delete" parameterType="java.lang.Integer">
        update shop_store_sns_tracelog
          set is_del = 1
        where strace_id = #{id,jdbcType=INTEGER}
    </update>
    
    <!--  根据ID修改状态  -->
    <update id="updateStateById" parameterType="java.lang.Integer">
        update shop_store_sns_tracelog
          set strace_state = #{state,jdbcType=INTEGER}
        where strace_id = #{id,jdbcType=INTEGER}
    </update>
    
    <!-- 根据ID查询实体 -->
    <select id="findLogById" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select <include refid="Base_Column_List" />
		from shop_store_sns_tracelog where strace_id = #{id,jdbcType=INTEGER} and is_del = 0
	</select>

</mapper>